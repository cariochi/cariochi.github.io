<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Spring Data Web Spec Â· CARIOCHI</title>
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
    <link rel="shortcut icon"type="image/svg+xml" href="/assets/images/favicon.svg"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Spring Data Web Spec | CARIOCHI</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Spring Data Web Spec" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Documentation hub for Reflecto, Objecto, Recordo, Expresso" />
<meta property="og:description" content="Documentation hub for Reflecto, Objecto, Recordo, Expresso" />
<link rel="canonical" href="https://cariochi.github.io/spec/" />
<meta property="og:url" content="https://cariochi.github.io/spec/" />
<meta property="og:site_name" content="CARIOCHI" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Spring Data Web Spec" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Documentation hub for Reflecto, Objecto, Recordo, Expresso","headline":"Spring Data Web Spec","url":"https://cariochi.github.io/spec/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/rouge.css">
    <link rel="stylesheet" href="/assets/css/site.css"/>
</head>
<body><header class="site-header">
    <div class="container">
        <a class="brand" href="/">
            <img src="/assets/images/logo.svg" alt="CARIOCHI"/>
<!--            <span>CARIOCHI</span>-->
        </a>

        <input type="checkbox" id="nav-toggle" class="nav-toggle" aria-label="Toggle navigation">

        <label for="nav-toggle" class="menu-toggle">
            <svg class="burger" viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
                <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" fill="none"/>
            </svg>
            <span class="menu-text">Menu</span>
        </label>

        <nav class="top-nav" aria-label="Projects">
            <ul><li>
                <a href="/reflecto">REFLECTO</a>
                </li><li>
                <a href="/objecto">OBJECTO</a>
                </li><li>
                <a href="/recordo">RECORDO</a>
                </li><li class="active">
                <a href="/spec">WEB SPEC</a>
                </li><li>
                <a href="/expresso">EXPRESSO</a>
                </li></ul>
        </nav><a class="header-github" href="https://github.com/cariochi/spring-data-web-spec" target="_blank" rel="noopener"><svg viewBox="0 0 16 16" width="20" height="20" aria-hidden="true" fill="currentColor">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38
                   0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13
                   -.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66
                   .07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15
                   -.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.59-.16 1.23-.24 1.87-.24
                   .64 0 1.28.08 1.87.24 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12
                   .51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48
                   0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
            </svg><span class="github-text">WEB SPEC</span>
        </a></div>
</header>
<main class="container">
    <div class="grid">
    <aside class="toc toc-desktop" aria-label="Table of contents">
    <div class="toc-inner">
        <h3>Spring Data Web Spec </h3>
        <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h1"><a href="#quick-start">Quick Start</a></li>
<li class="toc-entry toc-h1"><a href="#installation">Installation</a></li>
<li class="toc-entry toc-h1"><a href="#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h2"><a href="#spring-boot-autoconfiguration-recommended">Spring Boot autoconfiguration (recommended)</a></li>
<li class="toc-entry toc-h2"><a href="#manual-registration">Manual registration</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#annotations">Annotations</a>
<ul>
<li class="toc-entry toc-h2"><a href="#specparam">@Spec.Param</a></li>
<li class="toc-entry toc-h2"><a href="#specpath">@Spec.Path</a></li>
<li class="toc-entry toc-h2"><a href="#specheader">@Spec.Header</a></li>
<li class="toc-entry toc-h2"><a href="#specbody">@Spec.Body</a></li>
<li class="toc-entry toc-h2"><a href="#speccondition">@Spec.Condition</a></li>
<li class="toc-entry toc-h2"><a href="#specexpression">@Spec.Expression</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#operators">Operators</a></li>
<li class="toc-entry toc-h1"><a href="#license">License</a></li>
</ul>
    </div>
</aside>

<details class="toc-mobile">
    <summary>Table of Contents</summary>
    <aside class="toc" aria-label="Table of contents">
        <div class="toc-inner">
            <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h1"><a href="#quick-start">Quick Start</a></li>
<li class="toc-entry toc-h1"><a href="#installation">Installation</a></li>
<li class="toc-entry toc-h1"><a href="#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h2"><a href="#spring-boot-autoconfiguration-recommended">Spring Boot autoconfiguration (recommended)</a></li>
<li class="toc-entry toc-h2"><a href="#manual-registration">Manual registration</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#annotations">Annotations</a>
<ul>
<li class="toc-entry toc-h2"><a href="#specparam">@Spec.Param</a></li>
<li class="toc-entry toc-h2"><a href="#specpath">@Spec.Path</a></li>
<li class="toc-entry toc-h2"><a href="#specheader">@Spec.Header</a></li>
<li class="toc-entry toc-h2"><a href="#specbody">@Spec.Body</a></li>
<li class="toc-entry toc-h2"><a href="#speccondition">@Spec.Condition</a></li>
<li class="toc-entry toc-h2"><a href="#specexpression">@Spec.Expression</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#operators">Operators</a></li>
<li class="toc-entry toc-h1"><a href="#license">License</a></li>
</ul>
        </div>
    </aside>
</details>
    <article class="content">
<!--        <h1>Spring Data Web Spec</h1>-->
        <h1 id="overview">Overview</h1>

<p><strong>Spring Data Web Spec</strong> is a lightweight <strong>openâ€‘source</strong> library that maps HTTP request dataâ€”
(<strong>query parameters</strong>, <strong>headers</strong>, <strong>path variables</strong>, <strong>JSON body fields</strong>, and <strong>accessâ€‘control</strong> conditions) â€” into
Spring Data JPA <strong>Specifications</strong> using clear, concise annotations on controller method parameters.</p>

<p>ðŸ‘‰ Source code is available on <a href="https://github.com/cariochi/spring-data-web-spec">GitHub</a>.</p>

<h1 id="quick-start">Quick Start</h1>

<p>The simplest usage example is filtering entities by query parameters in a controller method:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/users"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">UserDto</span><span class="o">&gt;</span> <span class="nf">findUsers</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"role"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"role.name"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">ContainsIgnoreCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Condition</span><span class="o">(</span><span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.id"</span><span class="o">,</span> <span class="n">valueResolver</span> <span class="o">=</span> <span class="nc">AllowedOrganizations</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nc">Pageable</span> <span class="n">pageable</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">pageable</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">userMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>With just these annotations, incoming request parameters like <code class="language-plaintext highlighter-rouge">?role=ADMIN&amp;name=alex</code> will be automatically mapped into
a JPA <strong>Specification</strong>, and <strong>access-control</strong> rules (for example, restricting results to organizations allowed by
<code class="language-plaintext highlighter-rouge">AllowedOrganizations</code>) will also be applied to the query.</p>

<h1 id="installation">Installation</h1>

<p>Maven:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.cariochi.spec<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-data-web-spec<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.0.4<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h1 id="configuration">Configuration</h1>

<h2 id="spring-boot-autoconfiguration-recommended">Spring Boot autoconfiguration (recommended)</h2>

<p>If you use <strong>Spring Boot 3.x</strong> and have <strong>spring-data-web-spec</strong> on the classpath, the <code class="language-plaintext highlighter-rouge">SpecificationArgumentResolver</code>
will be automatically registered.</p>

<p>Autoconfiguration is enabled by default but can be disabled via:</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">cariochi.spec.enabled</span><span class="p">=</span><span class="s">false</span>
</code></pre></div></div>

<h2 id="manual-registration">Manual registration</h2>

<p>If you donâ€™t want to rely on <strong>autoconfiguration</strong> (or you use plain <strong>Spring MVC without Boot</strong>), annotate your
configuration class:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSpec</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="annotations">Annotations</h1>

<p>All annotations produce <code class="language-plaintext highlighter-rouge">Specification&lt;?&gt;</code> fragments that are combined with <strong>AND</strong> logic into a single query predicate.
Additionally, you can use the <a href="#specexpression"><code class="language-plaintext highlighter-rouge">@Spec.Expression</code></a> annotation to define custom combinations with groups
and Boolean
operators (AND, OR, NOT).</p>

<p>They share the same attributes:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">name</code> â€“ external name (query param, path variable, or header name)</li>
  <li><code class="language-plaintext highlighter-rouge">attribute</code> â€“ entity attribute path</li>
  <li><code class="language-plaintext highlighter-rouge">operator</code> â€“ comparison operator class (default <code class="language-plaintext highlighter-rouge">Equal</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">required</code> â€“ fail if the value is missing (default <code class="language-plaintext highlighter-rouge">false</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">distinct</code> â€“ apply <code class="language-plaintext highlighter-rouge">distinct</code> to the query (default <code class="language-plaintext highlighter-rouge">false</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">joinType</code> â€“ join type when traversing associations (default <code class="language-plaintext highlighter-rouge">INNER</code>)</li>
</ul>

<h2 id="specparam"><code class="language-plaintext highlighter-rouge">@Spec.Param</code></h2>

<p>Binds an HTTP <strong>query parameter</strong> to a condition.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/projects"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">ProjectDto</span><span class="o">&gt;</span> <span class="nf">findProjects</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"nameContains"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">ContainsIgnoreCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Project</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nc">Pageable</span> <span class="n">pageable</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">pageable</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">projectMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="specpath"><code class="language-plaintext highlighter-rouge">@Spec.Path</code></h2>

<p>Binds an HTTP <strong>path variable</strong> to a condition.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/organizations/{organizationId}/projects"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">ProjectDto</span><span class="o">&gt;</span> <span class="nf">findProjects</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Path</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"organizationId"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.id"</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"nameContains"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">ContainsIgnoreCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Project</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nc">Pageable</span> <span class="n">pageable</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">pageable</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">projectMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="specheader"><code class="language-plaintext highlighter-rouge">@Spec.Header</code></h2>

<p>Binds an HTTP <strong>header</strong> to a condition. This can also be used for multiâ€‘tenant support, for example separating data by
region, client, or other contextual header values.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/projects"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">ProjectDto</span><span class="o">&gt;</span> <span class="nf">findProjects</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"nameContains"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">ContainsIgnoreCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Header</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"X-Region"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.region"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Project</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nc">Pageable</span> <span class="n">pageable</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">pageable</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">projectMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="specbody"><code class="language-plaintext highlighter-rouge">@Spec.Body</code></h2>

<p>Binds a <strong>request body</strong> field to a condition. Supports <strong>JSON</strong> (<code class="language-plaintext highlighter-rouge">application/json</code>, <code class="language-plaintext highlighter-rouge">application/*+json</code>).</p>

<ul>
  <li>Nested keys via <strong>dot-notation</strong> (e.g. <code class="language-plaintext highlighter-rouge">filters.status</code>, <code class="language-plaintext highlighter-rouge">organization.region.id</code>).</li>
  <li>Works with both <strong>nested</strong> and <strong>flattened</strong> JSON structures.</li>
  <li>Can be freely <strong>combined</strong> with other annotations (<code class="language-plaintext highlighter-rouge">@Spec.Param</code>, <code class="language-plaintext highlighter-rouge">@Spec.Path</code>, <code class="language-plaintext highlighter-rouge">@Spec.Header</code>, <code class="language-plaintext highlighter-rouge">@Spec.Condition</code>,
<code class="language-plaintext highlighter-rouge">@Spec.Expression</code>).</li>
  <li>
    <p>If your body includes additional data beyond filters, you can still declare a regular <code class="language-plaintext highlighter-rouge">@RequestBody</code> parameter to
receive the full payload as-is. This is especially useful when the request contains pagination or metadata alongside
filter criteria. In such cases, the library ensures that filters and business data can coexist cleanly in a single
request.</p>

    <p>For this to work, you need to enable the <strong>body-repeatable</strong> option (disabled by default):</p>
  </li>
</ul>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="py">cariochi.spec.body-repeatable</span><span class="p">=</span><span class="s">true</span>
</code></pre></div></div>

<p>When enabled, the request body can be consumed multiple timesâ€”once for resolving specifications and again for binding to
the controller parameter. This feature is critical for robust API designs where controllers expect both structured
filters and domain-specific payloads.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/projects/search"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ProjectDto</span><span class="o">&gt;</span> <span class="nf">findProjects</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Body</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"filters.id"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Body</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"filters.name"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">ContainsIgnoreCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Body</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"filters.status"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Body</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"filters.labels"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"labels"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Expression</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"(filters.id || filters.status) &amp;&amp; (filters.name || filters.labels)"</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Project</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nd">@RequestBody</span> <span class="nc">SearchRequestDto</span> <span class="n">searchRequest</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">repo</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">searchRequest</span><span class="o">.</span><span class="na">getPageable</span><span class="o">()).</span><span class="na">map</span><span class="o">(</span><span class="nl">projectMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="speccondition"><code class="language-plaintext highlighter-rouge">@Spec.Condition</code></h2>

<p>A flexible annotation that lets you provide your own <code class="language-plaintext highlighter-rouge">valueResolver</code>. It can be used to express <strong>access-control
conditions</strong> (for example, filtering by user-allowed regions), or other custom sources of values.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/projects"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">ProjectDto</span><span class="o">&gt;</span> <span class="nf">findProjects</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Condition</span><span class="o">(</span><span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.region"</span><span class="o">,</span> <span class="n">valueResolver</span> <span class="o">=</span> <span class="nc">UserAllowedRegions</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Project</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nc">Pageable</span> <span class="n">pageable</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">projectService</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">pageable</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">projectMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="custom-value-resolver">Custom value resolver</h3>

<p>A custom <code class="language-plaintext highlighter-rouge">valueResolver</code> can be implemented as a <strong>Spring bean</strong>. For example, resolving allowed regions for the current
user:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserAllowedRegions</span> <span class="kd">implements</span> <span class="nc">Function</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserService</span> <span class="n">userService</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">apply</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">getAllowedRegions</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="specexpression"><code class="language-plaintext highlighter-rouge">@Spec.Expression</code></h2>

<p>Combine multiple atomic conditions with a Boolean expression defined right on the
controller parameter. The expression language supports:</p>

<ul>
  <li>textual operators: <code class="language-plaintext highlighter-rouge">AND</code>, <code class="language-plaintext highlighter-rouge">OR</code>, <code class="language-plaintext highlighter-rouge">NOT</code> (case-insensitive)</li>
  <li>symbolic operators: <code class="language-plaintext highlighter-rouge">&amp;&amp;</code>, <code class="language-plaintext highlighter-rouge">||</code>, <code class="language-plaintext highlighter-rouge">!</code></li>
  <li>parentheses for grouping</li>
</ul>

<blockquote>
  <p>Note: specifications declared on the controller method parameter but not referenced in the <code class="language-plaintext highlighter-rouge">@Spec.Expression</code> will
still be included, combined with <strong>AND</strong>.</p>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/organizations/{organizationId}/projects"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">ProjectDto</span><span class="o">&gt;</span> <span class="nf">findProjects</span><span class="o">(</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Path</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"organizationId"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.id"</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">ContainsIgnoreCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"status"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Param</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"labels"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Header</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"X-Region"</span><span class="o">,</span> <span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.region"</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Condition</span><span class="o">(</span><span class="n">attribute</span> <span class="o">=</span> <span class="s">"organization.region"</span><span class="o">,</span> <span class="n">valueResolver</span> <span class="o">=</span> <span class="nc">UserAllowedRegions</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="nc">In</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="nd">@Spec</span><span class="o">.</span><span class="na">Expression</span><span class="o">(</span><span class="s">"(id || name) &amp;&amp; (status || labels)"</span><span class="o">)</span>
        <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Project</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span>
        <span class="nc">Pageable</span> <span class="n">pageable</span>
<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">service</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="n">pageable</span><span class="o">).</span><span class="na">map</span><span class="o">(</span><span class="nl">projectMapper:</span><span class="o">:</span><span class="n">toDto</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="missing-parameter-behavior">Missing-parameter behavior</h3>

<p><code class="language-plaintext highlighter-rouge">@Spec.Expression</code> exposes a <code class="language-plaintext highlighter-rouge">strict</code> flag that controls how unknown/missing aliases are handled in the expression:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">strict = false</code> <em>(default)</em>: <strong>lenient</strong> â€” missing aliases evaluate to <code class="language-plaintext highlighter-rouge">null</code> and are ignored by combinators
(e.g., <code class="language-plaintext highlighter-rouge">(id OR name) AND (status OR labels)</code> with only <code class="language-plaintext highlighter-rouge">id</code> present simplifies to <code class="language-plaintext highlighter-rouge">id</code>).</li>
  <li><code class="language-plaintext highlighter-rouge">strict = true</code>: an exception is thrown if the expression references an alias with no corresponding specification.</li>
</ul>

<h1 id="operators">Operators</h1>

<p>By default, the library provides a set of built-in operator beans:</p>

<ul>
  <li>equality/inequality: <code class="language-plaintext highlighter-rouge">Equal</code>, <code class="language-plaintext highlighter-rouge">NotEqual</code></li>
  <li>membership: <code class="language-plaintext highlighter-rouge">In</code>, <code class="language-plaintext highlighter-rouge">NotIn</code></li>
  <li>string: <code class="language-plaintext highlighter-rouge">Contains</code>, <code class="language-plaintext highlighter-rouge">ContainsIgnoreCase</code>, <code class="language-plaintext highlighter-rouge">StartsWith</code>, <code class="language-plaintext highlighter-rouge">StartsWithIgnoreCase</code>, <code class="language-plaintext highlighter-rouge">EndsWith</code>, <code class="language-plaintext highlighter-rouge">EndsWithIgnoreCase</code></li>
  <li>null checks: <code class="language-plaintext highlighter-rouge">IsNull</code>, <code class="language-plaintext highlighter-rouge">IsNotNull</code></li>
  <li>comparison: <code class="language-plaintext highlighter-rouge">GreaterThan</code>, <code class="language-plaintext highlighter-rouge">GreaterThanOrEqualTo</code>, <code class="language-plaintext highlighter-rouge">LessThan</code>, <code class="language-plaintext highlighter-rouge">LessThanOrEqualTo</code></li>
</ul>

<p>In addition to the built-in set, you can define your <strong>own operators</strong> and use them in annotations just like the
provided ones. <strong>Custom operators</strong> are classes that implement the <code class="language-plaintext highlighter-rouge">Operator</code> interface. They are managed as <strong>Spring
beans</strong> and can be injected or created automatically by Spring.</p>

<h1 id="license">License</h1>

<p>The library is licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>

    </article>
    <a href="#top" class="back-to-top" title="Back to top">â†‘</a>
</div>

</main><footer class="site-footer">
    <div class="container footer-inner">
        <p class="copyright">Â© 2025 CARIOCHI.
            Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">GitHub Pages</a>
        </p>
        <p class="contact">Contact: <a href="mailto:vadym@deineka.com">vadym@deineka.com</a></p>
    </div>
</footer>
<script src="/assets/js/toc.js"></script>
<script src="/assets/js/copy-buttons.js"></script>
</body>
</html>
